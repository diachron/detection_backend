/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package org.diachron.detection.exploit;

/**
 *
 * @author rousakis
 */
public class DetChange extends DefChange implements Comparable<DetChange> {

    private String oldVersion, newVersion;

    public DetChange(String changeURI, String changeName, String oldV, String newV) {
        super(changeURI, changeName);
        int start = oldV.lastIndexOf("/");
        newVersion = newV.substring(start + 1);
        oldVersion = oldV.substring(start + 1);
    }

    public String getNewVersion() {
        return newVersion;
    }

    public String getOldVersion() {
        return oldVersion;
    }

    @Override
    public String toString() {
        StringBuilder sb = new StringBuilder();
        sb.append(changeName + "\n");
        for (Parameter param : parameters) {
            sb.append(param.getParamName() + " : " + param.getParamValue() + "\n");
        }
        sb.append(oldVersion + " -> " + newVersion);
        return sb.toString();
    }

    @Override
    public int compareTo(DetChange o) {
        String oChangeUri = o.changeURI;
        Double oOldVersion = Double.parseDouble(o.oldVersion);
        Double tOldVersion = Double.parseDouble(this.oldVersion);
        if (oOldVersion.doubleValue() != tOldVersion.doubleValue()) {
            return tOldVersion.compareTo(oOldVersion);
        } else {
            return this.changeURI.compareTo(oChangeUri);
        }
    }

}
